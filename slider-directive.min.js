"use strict";angular.module("jackrabbitsgroup.angular-slider-directive",[]).directive("jrgSliderDirective",["jrgPolynomial","jrgSliderService",function(jrgPolynomial,jrgSliderService){var template_html="";return template_html+="<div id = '{{slider_id}}' ng-mousemove = 'mousemoveHandler($event); $event.preventDefault()' class = '{{container_class}}'>",template_html+="<div ng-click = 'barClickHandler($event)' class = '{{bar_container_class}}' ng-style = 'bar_container_style'>",template_html+="<div id = '{{slider_id}}SliderBar' style = 'position:relative; width:100%;'>",template_html+='<div class = \'{{left_bg_class}}\' ng-style = \'{"width": left_bg_width + "%", "position": "absolute",  "left": "0%"}\'> </div>',template_html+="<div ng-repeat = 'handle in handles' id = '{{slider_id}}Handle{{$index}}' ng-mousedown = 'startHandleDrag($index); $event.preventDefault()' class = '{{handle_class}}' ng-style = '{\"z-index\": handle.zindex, \"left\": handle.left + \"%\", \"position\": \"absolute\"}' ng-bind-html = 'handle.innerhtml'></div>",template_html+='<div ng-repeat = \'interior in interiors\' class = \'{{interior_bg_class}}\' ng-style = \'{"left": interior.left + "%", "width": interior.width + "%", "position": "absolute"}\'> </div>',template_html+='<div class = \'{{right_bg_class}}\' ng-style = \'{"width": right_bg_width + "%", "position": "absolute", "right": "0%"}\'> </div>',template_html+="<div>",template_html+='<div ng-repeat = \'tick in ticks\' class = \'{{ticks_class}}\' ng-style = \'{"position": "absolute", "left": tick.left + "%"}\'> </div>',template_html+="</div>",template_html+="</div>",template_html+="<div class = '{{ticks_values_container_class}}' style = 'position: relative;' ng-show = 'use_ticks'>",template_html+='<div ng-repeat = \'tick in ticks\' class = \'{{ticks_value_class}}\' ng-style = \'{"position": "absolute", "left": tick.left + "%"}\'> {{tick.name}} </div>',template_html+="</div>",template_html+="</div>",template_html+="</div>",{restrict:"E",priority:0,scope:{handle_values:"=sliderHandleVariable",slider_id:"@sliderId",slider_opts:"=sliderOpts"},replace:!0,template:template_html,link:function(scope,element,attrs){var ii,defaults,building_slider,building_queued,scale_function_poly,cur_handle,dragging,slider_offset,slider_width,slider_init,increments,user_values_flag,rotate_radians;defaults={num_handles:1,slider_min:0,slider_max:100,precision:0,scale_string:"[1, 1]",zero_method:"newton",increment:0,user_values:"",evt_mouseup:"",slider_moveable:!0,use_array:!0,rotate:0,bar_container_class:"jrg-slider-directive-bar",left_bg_class:"jrg-slider-directive-bar-active",interior_bg_class:"jrg-slider-directive-bar-active",right_bg_class:"jrg-slider-directive-bar-inactive",handle_class:"jrg-slider-directive-bar-handle",handle_html:'<div class = "jrg-slider-directive-bar-handle-inner"></div>',units_pre:"",units_post:"",use_ticks:!1,ticks_values:"placeholder",ticks_class:"jrg-slider-directive-ticks",ticks_values_container_class:"jrg-slider-directive-ticks-values-container",ticks_value_class:"jrg-slider-directive-ticks-value"};var evt_get_value="",evt_return_value="",evt_get_all_values="",evt_return_all_values="",evt_set_value="",evt_init_slider="",evt_init_slider_finished="";scale_function_poly=jrgPolynomial.stringToPoly("[1, 1]");var initSlider=function(){building_slider=!0,building_queued=!1;for(var xx in defaults)scope[xx]=void 0===scope.slider_opts[xx]?defaults[xx]:scope.slider_opts[xx];if("placeholder"==scope.ticks_values&&(scope.ticks_values=scope.user_values.length>0?[scope.user_values[0],scope.user_values[scope.user_values.length-1]]:[scope.slider_min,scope.slider_max]),nameInterfaceEvents(),jrgSliderService.register(scope.slider_id,endHandleDrag),scope.initial_values=!1,void 0===scope.handle_values)scope.use_array=parseBoolean(scope.use_array,defaults.use_array),scope.handle_values=scope.use_array===!1?"":[];else if(isArray(scope.handle_values)===!1)scope.initial_values=scope.handle_values;else if(void 0!==scope.handle_values.length&&scope.handle_values.length>0){var array_copy=[];for(ii=0;ii<scope.handle_values.length;ii++)array_copy[ii]=scope.handle_values[ii];scope.initial_values=array_copy}parseData(),setStyles(),setHandles(),scope.use_ticks===!0&&setTicks(),setJqueryTouch(),building_slider=!1,building_queued===!0?initSlider():scope.$emit(evt_init_slider_finished,{id:scope.slider_id,values:scope.handle_values})},parseData=function(){if(scope.num_handles=parseInt(scope.num_handles,10),scope.slider_min=parseFloat(scope.slider_min),scope.slider_max=parseFloat(scope.slider_max),scope.increment=parseFloat(scope.increment),scope.precision=parseInt(scope.precision,10),scope.rotate=reRangeAngle(parseFloat(scope.rotate)),scope.slider_moveable=parseBoolean(scope.slider_moveable,defaults.slider_moveable),scope.use_array=parseBoolean(scope.use_array,defaults.use_array),user_values_flag=!1,""!==scope.user_values&&void 0!==scope.user_values){for(user_values_flag=!0,ii=0;ii<scope.user_values.length;ii++)if(void 0===scope.user_values[ii].val){var temp_val=scope.user_values[ii];scope.user_values[ii]={val:temp_val,name:temp_val}}else void 0===scope.user_values[ii].name&&(scope.user_values[ii].name=scope.user_values[ii].val);scope.slider_min=0,scope.slider_max=scope.user_values.length-1,scope.increment=1,scope.precision=0}scope.left_bg_width=0,scope.right_bg_width=0,cur_handle=0,dragging=!1,scope.recent_dragging=!1,scope.handles=[],scope.interiors=[],scope.ticks=[],increments=[],slider_offset={x:0,y:0},slider_width=100,slider_init=!1,rotate_radians=scope.rotate*(2*Math.PI/360),0!==scope.rotate&&90!==scope.rotate&&-90!==scope.rotate&&180!==scope.rotate&&(slider_offset.m1=Math.tan(rotate_radians),slider_offset.m2=-1/slider_offset.m1),0===scope.increment&&(scale_function_poly=jrgPolynomial.stringToPoly(scope.scale_string))},parseBoolean=function(bool,default_val){return"false"==bool||bool===!1?!1:"true"==bool||bool===!0?!0:default_val},setStyles=function(){var ro="rotate("+scope.rotate+"deg)";scope.bar_container_style={"-moz-transform":ro,"-webkit-transform":ro,"-o-transform":ro,"-ms-transform":ro,transform:ro}},setHandles=function(){var handle_htmls;if(-1!=scope.handle_html.indexOf("~"))for(handle_htmls=scope.handle_html.split("~"),ii=handle_htmls.length;ii<scope.num_handles;ii++)handle_htmls[ii]="";else for(handle_htmls=[],ii=0;ii<scope.num_handles;ii++)handle_htmls[ii]=scope.handle_html;for(ii=0;ii<scope.num_handles;ii++){var left_val;1==scope.num_handles?(left_val=0,scope.right_bg_width=100):left_val=100/(scope.num_handles-1)*ii;var value_in_handle=!1;-1!=handle_htmls[ii].indexOf("$$value")&&(value_in_handle=!0),scope.handles[ii]={zindex:10,left:left_val,value:calculate_value(left_val),html_string:handle_htmls[ii],value_in_handle:value_in_handle},user_values_flag===!1?(scope.handles[ii].display_value=scope.handles[ii].value,scope.handles[ii].return_value=scope.handles[ii].value):(scope.handles[ii].display_value=scope.user_values[scope.handles[ii].value].name,scope.handles[ii].return_value=scope.user_values[scope.handles[ii].value].val),scope.use_array===!1?scope.handle_values=scope.handles[ii].return_value:scope.handle_values[ii]=scope.handles[ii].return_value,update_zindex(ii),scope.handles[ii].value_in_handle===!0?parseHandleHtml(ii):scope.handles[ii].innerhtml=scope.handles[ii].html_string}for(ii=0;ii<scope.num_handles-1;ii++)scope.interiors[ii]={left:scope.handles[ii].left,width:scope.handles[ii+1].left-scope.handles[ii].left};if(0!==scope.increment&&void 0!==scope.increment){var cur_val=scope.slider_min;for(ii=0;cur_val<scope.slider_max;ii++)increments[ii]={},increments[ii].value=cur_val,increments[ii].left=calculate_left(cur_val),cur_val+=scope.increment;if(increments[ii]={},increments[ii].value=scope.slider_max,increments[ii].left=100,scope.initial_values===!1){var distances_to_increment=[];for(ii=0;ii<scope.num_handles;ii++){var new_left=findNearestIncrement(scope.handles[ii].left);distances_to_increment[ii]={handle:ii,distance:Math.abs(scope.handles[ii].left-new_left),new_left:new_left}}for(distances_to_increment.sort(function(a,b){return a.distance<b.distance?-1:b.distance<a.distance?1:0}),ii=0;ii<scope.num_handles;ii++)moveHandle(distances_to_increment[ii].handle,distances_to_increment[ii].new_left)}}if(scope.initial_values===!1);else for((""===evt_set_value||void 0===evt_set_value)&&nameInterfaceEvents(),ii=0;ii<scope.num_handles;ii++)scope.use_array===!1?setHandleValue(ii,scope.initial_values):setHandleValue(ii,scope.initial_values[ii])},setTicks=function(){for(var ii=0;ii<scope.ticks_values.length;ii++){scope.ticks[ii]=void 0===scope.ticks_values[ii].val?{val:scope.ticks_values[ii],name:scope.units_pre+scope.ticks_values[ii]+scope.units_post}:void 0===scope.ticks_values[ii].name?{val:scope.ticks_values[ii].val,name:scope.units_pre+scope.ticks_values[ii].val+scope.units_post}:{val:scope.ticks_values[ii].val,name:scope.ticks_values[ii].name};var new_left;if(user_values_flag===!0){var index,jj;for(jj=0;jj<scope.user_values.length;jj++)scope.user_values[jj].val.toString()==scope.ticks[ii].val.toString()&&(index=jj,jj=scope.user_values.length);new_left=increments[index].left}else new_left=calculate_left(scope.ticks[ii].val);scope.ticks[ii].left=new_left}},setJqueryTouch=function(){var initTouch=function(){if(document.getElementById(scope.slider_id+"Handle0")){for(ii=0;ii<scope.num_handles;ii++)!function(index){var handle_ele=$("#"+scope.slider_id+"Handle"+index);handle_ele.unbind("touchstart"),handle_ele.bind("touchstart",function(){scope.$apply(function(){scope.startHandleDrag(index)})},!1)}(ii);var slider_ele=$("#"+scope.slider_id);slider_ele.unbind("touchmove"),slider_ele.bind("touchmove",function(event){event.preventDefault();var touch=event.originalEvent;scope.$apply(function(){scope.touchmoves++,scope.mousemoveHandler(touch)})})}else setTimeout(function(){scope.$apply(function(){initTouch()})},500)};initTouch()},calculate_value=function(left){return fixPrecision(scope.slider_min+(scope.slider_max-scope.slider_min)*jrgPolynomial.evalPoly(scale_function_poly,left/100),scope.precision)},invert_value=function(value){var ret2,zero_poly=jrgPolynomial.subPoly(scale_function_poly,jrgPolynomial.buildPoly([value],[0]));if("bisection"!=scope.zero_method){var ret1=jrgPolynomial.findPolyZeroNewton({poly:zero_poly,guess:value});return ret1.err?(ret2=jrgPolynomial.findPolyZeroBisection({poly:zero_poly,a:0,b:1}),ret2.val):ret1.val}return ret2=jrgPolynomial.findPolyZeroBisection({poly:zero_poly,a:0,b:1}),ret2.val},calculate_left=function(value){return 100*invert_value((value-scope.slider_min)/(scope.slider_max-scope.slider_min))},update_backgrounds=function(index){0!==index?(scope.interiors[index-1].left=scope.handles[index-1].left,scope.interiors[index-1].width=scope.handles[index].left-scope.handles[index-1].left):scope.left_bg_width=scope.handles[index].left,index<scope.num_handles-1?(scope.interiors[index].left=scope.handles[index].left,scope.interiors[index].width=scope.handles[index+1].left-scope.handles[index].left):scope.right_bg_width=100-scope.handles[index].left},update_zindex=function(index){scope.handles[index].zindex=scope.handles[index].left<2?10+index+1:10+scope.num_handles-index},fixPrecision=function(number,digits){if(digits>=0)return parseFloat(number.toFixed(digits));var round_unit=Math.pow(10,-1*digits);return round_unit*Math.round(number/round_unit)},reRangeAngle=function(angle){for(;angle>180;)angle-=360;for(;-180>=angle;)angle+=360;return angle},initSliderOffsets=function(){if(scope.slider_moveable===!0||slider_init===!1){var bar=$("#"+scope.slider_id+"SliderBar");slider_width=bar.outerWidth(),slider_offset.x=bar.offset().left,slider_offset.y=bar.offset().top,scope.rotate<0&&(slider_offset.y+=slider_width*Math.abs(Math.sin(rotate_radians))),(scope.rotate>90||scope.rotate<-90)&&(slider_offset.x+=slider_width*Math.abs(Math.cos(rotate_radians))),void 0!==slider_offset.m1&&(slider_offset.b1=-1*slider_offset.m1*slider_offset.x+slider_offset.y),slider_init=!0}};scope.barClickHandler=function(event){if(scope.recent_dragging===!1){initSliderOffsets();var x_coord=event.pageX,y_coord=event.pageY,new_left=convertMouseToSliderPercent(x_coord,y_coord);0!==scope.increment&&void 0!==scope.increment&&(new_left=findNearestIncrement(new_left));var handle_index=0;if(scope.handles[scope.num_handles-1].left<=new_left)handle_index=scope.num_handles-1;else if(scope.handles[0].left>=new_left)handle_index=0;else{for(ii=0;new_left>scope.handles[ii].left;ii++);handle_index=scope.handles[ii].left-new_left>new_left-scope.handles[ii-1].left?ii-1:ii}moveHandle(handle_index,new_left),""!==scope.evt_mouseup&&void 0!==scope.evt_mouseup&&scope.$emit(scope.evt_mouseup,{num_handles:scope.num_handles,handle:handle_index,id:scope.slider_id,value:scope.handles[handle_index].return_value})}},scope.startHandleDrag=function(index){initSliderOffsets(),cur_handle=index,dragging=!0,scope.recent_dragging=!0,jrgSliderService.activate(scope.slider_id)},scope.mousemoveHandler=function(event){dragging===!0&&continueHandleDrag(event)};var continueHandleDrag=function(event){var x_coord,y_coord;event.touches&&event.touches.length?(x_coord=event.touches[0].pageX,y_coord=event.touches[0].pageY):(x_coord=event.pageX,y_coord=event.pageY);var new_left=convertMouseToSliderPercent(x_coord,y_coord);0!==scope.increment&&void 0!==scope.increment&&(new_left=findNearestIncrement(new_left)),moveHandle(cur_handle,new_left)},convertMouseToSliderPercent=function(x_coord,y_coord){if(0===scope.rotate)return 100*((x_coord-slider_offset.x)/slider_width);if(180===scope.rotate)return 100*((slider_offset.x-x_coord)/slider_width);if(90===scope.rotate)return 100*((y_coord-slider_offset.y)/slider_width);if(-90===scope.rotate)return 100*((slider_offset.y-y_coord)/slider_width);var x_new=(y_coord-slider_offset.m2*x_coord-slider_offset.b1)/(slider_offset.m1-slider_offset.m2),y_new=slider_offset.m1*x_new+slider_offset.b1;if(scope.rotate<90&&scope.rotate>-90&&x_new<=slider_offset.x)return 0;if(scope.rotate>90&&scope.rotate<-90&&x_new>=slider_offset.x)return 0;var dist=Math.sqrt(Math.pow(slider_offset.x-x_new,2)+Math.pow(slider_offset.y-y_new,2)),left=100*(dist/slider_width);return left},moveHandle=function(handle_index,new_left){handle_index<scope.num_handles-1&&new_left>scope.handles[handle_index+1].left?new_left=scope.handles[handle_index+1].left:handle_index>0&&new_left<scope.handles[handle_index-1].left?new_left=scope.handles[handle_index-1].left:0>new_left?new_left=0:new_left>100&&(new_left=100),scope.handles[handle_index].left=new_left,scope.handles[handle_index].value=calculate_value(new_left),user_values_flag===!1?(scope.handles[handle_index].display_value=scope.handles[handle_index].value,scope.handles[handle_index].return_value=scope.handles[handle_index].value):(scope.handles[handle_index].display_value=scope.user_values[scope.handles[handle_index].value].name,scope.handles[handle_index].return_value=scope.user_values[scope.handles[handle_index].value].val),scope.handles[handle_index].value_in_handle===!0&&parseHandleHtml(handle_index),scope.use_array===!1?scope.handle_values=scope.handles[handle_index].return_value:scope.handle_values[handle_index]=scope.handles[handle_index].return_value,update_backgrounds(handle_index),update_zindex(handle_index)},endHandleDrag=function(){var endHandleDragHelper=function(){dragging===!0&&(dragging=!1,jrgSliderService.deactivate(),""!==scope.evt_mouseup&&void 0!==scope.evt_mouseup&&scope.$emit(scope.evt_mouseup,{num_handles:scope.num_handles,handle:cur_handle,id:scope.slider_id,value:scope.handles[cur_handle].return_value}),setTimeout(function(){scope.$apply(function(){scope.recent_dragging=!1})},300))};void 0===scope.$$phase?scope.$apply(function(){endHandleDragHelper()}):endHandleDragHelper()},findNearestIncrement=function(left){if(left>=100)return 100;if(0>=left)return 0;var increment_left=increments[1].left,low_index=Math.floor(left/increment_left);return left-increments[low_index].left<increments[low_index+1].left-left?increments[low_index].left:increments[low_index+1].left},parseHandleHtml=function(index){scope.handles[index].innerhtml=scope.handles[index].html_string.replace("$$value",scope.units_pre+scope.handles[index].display_value+scope.units_post)},setHandleValue=function(handle,value){var new_left;if(user_values_flag===!0){for(var index,ii=0;ii<scope.user_values.length;ii++)scope.user_values[ii].val.toString()==value.toString()&&(index=ii,ii=scope.user_values.length);new_left=increments[index].left}else new_left=calculate_left(value);moveHandle(handle,new_left)},nameInterfaceEvents=function(){evt_get_value="evtSliderGetValue"+scope.slider_id,evt_return_value="evtSliderReturnValue"+scope.slider_id,evt_get_all_values="evtSliderGetAllValues"+scope.slider_id,evt_return_all_values="evtSliderReturnAllValues"+scope.slider_id,evt_set_value="evtSliderSetValue"+scope.slider_id,evt_init_slider="evtInitSlider"+scope.slider_id,evt_init_slider_finished="evtSliderInitialized"+scope.slider_id};document.ready=function(){setJqueryTouch()},scope.$on(evt_get_value,function(evt,params){var handle=0;void 0!==params&&void 0!==params.handle&&(handle=params.handle),scope.$emit(evt_return_value,{value:scope.handles[handle].return_value})}),scope.$on(evt_get_all_values,function(){var ret_array=[];for(ii=0;ii<scope.handles.length;ii++)ret_array[ii]=scope.handles[ii].return_value;scope.$emit(evt_return_all_values,{values:ret_array})}),scope.$on(evt_set_value,function(evt,params){var handle=0;void 0!==params&&void 0!==params.handle&&(handle=params.handle),setHandleValue(handle,params.value)}),scope.$on(evt_init_slider,function(){building_slider===!0?building_queued=!0:initSlider()});var isArray=function(array1){return"[object Array]"===Object.prototype.toString.apply(array1)?!0:!1};initSlider(),attrs.$observe("sliderId",function(){initSlider()})}}}]).factory("jrgSliderService",[function(){var inst={sliders:{},active:!1,register:function(id,callback){this.sliders[id]=callback},remove:function(id){delete this.sliders[id]},activate:function(id){this.active=id},deactivate:function(){this.active=!1},clickHandler:function(thisObj){thisObj.active===!1||thisObj.sliders[thisObj.active]()},init:function(){var thisObj=this;window.addEventListener("mouseup",function(event){thisObj.clickHandler(thisObj,event)}),$(window).bind("touchend",function(event){thisObj.clickHandler(thisObj,event)})}};return inst.init(),inst}]).factory("jrgPolynomial",[function(){var inst={buildPoly:function(coeffs,exps){var ii,poly=[];for(ii=0;ii<coeffs.length;ii++)poly[ii]={coeff:coeffs[ii],exp:exps[ii]};return poly},stringToPoly:function(poly_string){var ii,terms=poly_string.split("~"),poly=[];for(ii=0;ii<terms.length;ii++)poly[ii]={},poly[ii].coeff=parseFloat(terms[ii].slice(terms[ii].indexOf("[")+1),terms[ii].slice(terms[ii].indexOf(",")-1)),poly[ii].exp=parseFloat(terms[ii].slice(terms[ii].indexOf(",")+1),terms[ii].slice(terms[ii].indexOf("]")-1));return poly},evalPoly:function(poly,xx){var ii,val=0;for(ii=0;ii<poly.length;ii++)val+=poly[ii].coeff*Math.pow(xx,poly[ii].exp);return val},polyToFunction:function(poly){var thisObj=this;return function(xx){return thisObj.evalPoly(poly,xx)}},differentiatePoly:function(poly){var ii,thisObj=this,deriv=thisObj.copyPoly(poly);for(ii=0;ii<deriv.length;ii++)0===deriv[ii].exp?deriv[ii].coeff=0:(deriv[ii].coeff=deriv[ii].coeff*deriv[ii].exp,deriv[ii].exp=deriv[ii].exp-1);return deriv},integratePoly:function(poly){var ii,thisObj=this,integral=thisObj.copyPoly(poly);for(ii=0;ii<integral.length;ii++){if(-1==integral[ii].exp)return console.log("ERROR: jrgPolynomial.integratePoly can't handle polynomials with an exponent = -1 term!"),poly;integral[ii].exp=integral[ii].exp+1,integral[ii].coeff=integral[ii].coeff/integral[ii].exp}return integral},combinePolyTerms:function(poly){var ii,cur_exp,new_poly=[],term_counter=0;for(poly=poly.sort(function(a,b){return a.exp<b.exp?-1:a.exp>b.exp?1:0}),cur_exp=poly[0].exp,new_poly[term_counter]={coeff:0,exp:cur_exp},ii=0;ii<poly.length;ii++)cur_exp==poly[ii].exp?new_poly[term_counter].coeff=new_poly[term_counter].coeff+poly[ii].coeff:(term_counter++,cur_exp=poly[ii].exp,new_poly[term_counter]={coeff:poly[ii].coeff,exp:cur_exp});return new_poly},scalePoly:function(poly,scalar){var ii,thisObj=this,new_poly=thisObj.copyPoly(poly);for(ii=0;ii<new_poly.length;ii++)new_poly[ii].coeff=new_poly[ii].coeff*scalar;return new_poly},addPoly:function(poly1,poly2){return this.combinePolyTerms(poly1.concat(poly2))},subPoly:function(poly1,poly2){return this.addPoly(poly1,this.scalePoly(poly2,-1))},findPolyZeroNewton:function(params){var thisObj=this;if(void 0===params||void 0===params.poly||void 0===params.guess)return console.log("Error in jrgPolynomial.findPolyZeroNewton: params.poly and params.guess must be defined"),{err:!0,val:0};var poly=params.poly,guess=params.guess,epsilon=1e-5;void 0!==params.epsilon&&(epsilon=params.epsilon);var max_iterations=50;if(void 0!==params.max_iterations&&(max_iterations=params.max_iterations),Math.abs(thisObj.evalPoly(poly,guess))<epsilon)return{err:!1,val:guess};var ff=thisObj.polyToFunction(poly),f_prime=thisObj.polyToFunction(thisObj.differentiatePoly(poly)),iterations=0,iterator=function(xx){return Math.abs(ff(xx))<epsilon?{err:!1,val:xx}:(iterations++,iterations>max_iterations?(console.log("Error in jrgPolynomial.findPolyZeroNewton: Too many iterations without finding answer"),{err:!0,val:xx}):0===f_prime(xx)?iterator(xx+.1):iterator(xx-ff(xx)/f_prime(xx)))};return iterator(guess-ff(guess)/f_prime(guess))},findPolyZeroBisection:function(params){var thisObj=this;if(void 0===params||void 0===params.poly||void 0===params.a||void 0===params.b)return console.log("Error in jrgPolynomial.findPolyZeroBisection: params.poly, params.a, and params.b must be defined"),{err:!0,val:0};var poly=params.poly,epsilon=1e-4;void 0!==params.epsilon&&(epsilon=params.epsilon);var ff=thisObj.polyToFunction(poly),iterator=function(a,b){var f_a=ff(a),f_b=ff(b);if(Math.abs(f_a)<epsilon)return{err:!1,val:a};if(Math.abs(f_b)<epsilon)return{err:!1,val:b};if(f_a>0&&f_b>0||0>f_a&&0>f_b)return console.log("Error in jrgPolynomial.findPolyZeroBisection: Bad interval. The polynomial must be >= 0 at one endpoint and <= 0 at the other."),{err:!0,val:0};var c=(a+b)/2,f_c=ff(c);return Math.abs(f_c)<epsilon?{err:!1,val:c}:0>f_c?f_a>0?iterator(a,c):iterator(c,b):0>f_a?iterator(a,c):iterator(c,b)};return iterator(params.a,params.b)},copyPoly:function(poly){var ii,copy=[];for(ii=0;ii<poly.length;ii++)copy[ii]={coeff:poly[ii].coeff,exp:poly[ii].exp};return copy}};return inst}]);